# Story 2.2 手工验收测试文档
## 动物emoji表情显示系统

### 测试信息
- **故事编号**: Story 2.2
- **测试日期**: ___________
- **测试人员**: ___________
- **环境**: ___________
- **版本**: ___________

---

## AC1: 动物emoji表情生成

### 测试步骤 1.1: 验证不同动物类型的emoji显示
**预期结果**: 显示格式为 `{动物emoji}{现有表情}`

| 测试用例 | 动物类型 | 能量状态 | 预期emoji | 预期表情格式 | 实际结果 | 通过/失败 |
|---------|---------|---------|----------|------------|---------|----------|
| TC1.1.1 | 猫(CAT) | 高能量(>70) | 🐱 | 🐱(^_^) | | □ Pass □ Fail |
| TC1.1.2 | 狗(DOG) | 中能量(30-70) | 🐶 | 🐶(o_o) | | □ Pass □ Fail |
| TC1.1.3 | 兔子(RABBIT) | 低能量(<30) | 🐰 | 🐰(x_x) | | □ Pass □ Fail |
| TC1.1.4 | 熊猫(PANDA) | 睡眠状态 | 🐼 | 🐼(-_-) | | □ Pass □ Fail |
| TC1.1.5 | 狐狸(FOX) | 任意状态 | 🦊 | 🦊(表情) | | □ Pass □ Fail |

**执行命令**: `ccpet check`

**验证点**:
- [ ] emoji字符正确显示
- [ ] emoji与表情正确组合
- [ ] 不同动物类型显示对应emoji

**备注**: ___________

---

### 测试步骤 1.2: 验证animalType字段映射
**预期结果**: 动物emoji根据宠物的animalType字段正确确定

**执行命令**: 
1. `ccpet check` - 查看当前宠物类型
2. 记录animalType值
3. 验证对应emoji显示

| 步骤 | animalType值 | 预期emoji | 实际emoji | 通过/失败 |
|------|-------------|----------|----------|----------|
| 1 | | | | □ Pass □ Fail |

**备注**: ___________

---

## AC2: 表情显示服务更新

### 测试步骤 2.1: 验证getAnimatedExpression()方法
**预期结果**: 方法返回带动物emoji的完整表情

**执行命令**: 通过状态栏或命令行观察表情变化

**测试场景**:
- [ ] 表情动画轮播功能正常工作
- [ ] emoji前缀在动画中保持一致
- [ ] 动画切换时emoji不消失

**验证**:
- [ ] 动画轮播: 表情部分变化，emoji部分保持不变
- [ ] 完整格式: 始终显示为 `{emoji}{表情}` 格式

**备注**: ___________

---

### 测试步骤 2.2: 表情长度计算验证
**预期结果**: 表情长度计算正确处理emoji字符

**执行方法**: 观察状态栏显示是否对齐正确

**验证点**:
- [ ] 状态栏文本不超出边界
- [ ] emoji字符宽度计算正确
- [ ] 文本对齐没有异常

**备注**: ___________

---

## AC3: 状态栏显示兼容

### 测试步骤 3.1: 状态栏布局验证
**预期结果**: 状态栏正确显示动物emoji + 表情组合，布局不被破坏

**执行环境测试**:

| 终端类型 | 操作系统 | emoji显示 | 布局正确 | 通过/失败 |
|---------|---------|-----------|----------|----------|
| VS Code Terminal | macOS | □ 正常 □ 异常 | □ 正常 □ 异常 | □ Pass □ Fail |
| iTerm2 | macOS | □ 正常 □ 异常 | □ 正常 □ 异常 | □ Pass □ Fail |
| Terminal.app | macOS | □ 正常 □ 异常 | □ 正常 □ 异常 | □ Pass □ Fail |
| Windows Terminal | Windows | □ 正常 □ 异常 | □ 正常 □ 异常 | □ Pass □ Fail |
| PowerShell | Windows | □ 正常 □ 异常 | □ 正常 □ 异常 | □ Pass □ Fail |
| GNOME Terminal | Linux | □ 正常 □ 异常 | □ 正常 □ 异常 | □ Pass □ Fail |

**备注**: ___________

---

### 测试步骤 3.2: Fallback机制验证
**预期结果**: 在不支持emoji的环境下提供fallback机制

**测试方法**: 
1. 模拟或使用不支持emoji的终端环境
2. 或通过配置禁用emoji功能

**验证步骤**:
- [ ] 检查是否存在emoji配置选项
- [ ] 禁用emoji后显示为纯表情格式
- [ ] fallback模式下功能完全正常

**备注**: ___________

---

## AC4: 命令行显示支持

### 测试步骤 4.1: 终端输出验证
**预期结果**: 终端输出正确显示动物emoji，字符对齐和格式正确

**执行命令**: `ccpet check`

**跨平台显示测试**:

| 平台 | 终端 | emoji显示 | 字符对齐 | 格式正确 | 通过/失败 |
|------|------|-----------|----------|----------|----------|
| macOS | 各类终端 | □ 正常 | □ 正常 | □ 正常 | □ Pass □ Fail |
| Windows | 各类终端 | □ 正常 | □ 正常 | □ 正常 | □ Pass □ Fail |
| Linux | 各类终端 | □ 正常 | □ 正常 | □ 正常 | □ Pass □ Fail |

**验证点**:
- [ ] emoji字符在终端中正常显示
- [ ] 没有出现乱码或显示错误
- [ ] 文本对齐没有因emoji宽度问题而错位

**备注**: ___________

---

### 测试步骤 4.2: emoji字符宽度计算
**预期结果**: 正确处理emoji字符宽度计算问题

**测试方法**:
1. 观察长文本输出的对齐情况
2. 检查状态信息的格式化显示

**验证点**:
- [ ] 多行显示时对齐正确
- [ ] emoji不影响文本布局
- [ ] 长内容截断时考虑emoji宽度

**备注**: ___________

---

## AC5: 向后兼容性保证

### 测试步骤 5.1: 旧数据兼容性测试
**预期结果**: 现有的宠物数据没有animalType字段时，分配默认动物类型

**测试方法**:
1. 检查现有宠物数据
2. 如果没有animalType字段，观察是否分配默认值

**验证步骤**:
- [ ] 旧数据加载时不出现错误
- [ ] 自动分配默认动物类型(猫 🐱)
- [ ] 所有现有功能继续正常工作

**备注**: ___________

---

### 测试步骤 5.2: 功能完整性测试
**预期结果**: 不会出现显示错误或崩溃，数据迁移透明无感

**执行命令**: 
1. `ccpet check`
2. `ccpet feed`
3. `ccpet play`

**验证点**:
- [ ] 所有原有命令功能正常
- [ ] 没有出现异常或错误
- [ ] 宠物状态更新正常
- [ ] 数据迁移过程用户无感知

**备注**: ___________

---

## 整体功能验收

### 综合测试场景

#### 场景1: 新宠物显示验证
**执行步骤**:
1. 创建或查看新宠物
2. 确认能量状态为85（高能量）
3. 观察显示结果

**预期结果**: 应该显示 "🐱(^_^)" 或类似快乐表情

**实际结果**: ___________
**通过/失败**: □ Pass □ Fail

---

#### 场景2: 动物类型变化验证
**执行步骤**:
1. 观察不同时间的宠物状态
2. 记录不同动物类型的显示

**预期结果**: 
- 看到对应的动物emoji：🐱🐶🐰🐼🦊
- 表情根据能量状态正确变化

**实际结果**: ___________
**通过/失败**: □ Pass □ Fail

---

#### 场景3: 兼容性处理验证
**执行步骤**:
1. 在不支持emoji的终端环境测试
2. 或禁用emoji功能

**预期结果**: 
- fallback到原有的纯文本表情显示
- 或使用ASCII替代符号

**实际结果**: ___________
**通过/失败**: □ Pass □ Fail

---

## 测试总结

### 测试覆盖情况
- [ ] AC1: 动物emoji表情生成 - 完成
- [ ] AC2: 表情显示服务更新 - 完成  
- [ ] AC3: 状态栏显示兼容 - 完成
- [ ] AC4: 命令行显示支持 - 完成
- [ ] AC5: 向后兼容性保证 - 完成

### 发现的问题

| 问题编号 | 问题描述 | 严重程度 | 状态 |
|---------|----------|----------|------|
| | | | |
| | | | |

### 整体验收结果
- [ ] **通过** - 所有验收标准都满足，功能正常
- [ ] **条件通过** - 存在非关键问题，但不影响主要功能
- [ ] **不通过** - 存在关键问题，需要修复后重新测试

### 测试人员签名
**测试人员**: ___________  
**测试日期**: ___________  
**签名**: ___________

### 备注
___________
___________
___________