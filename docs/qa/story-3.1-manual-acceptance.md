# Story 3.1 手工验收测试文档
## 持续宠物监控功能

### 测试信息
- **故事编号**: Story 3.1
- **测试日期**: ___________
- **测试人员**: ___________
- **环境**: ___________
- **版本**: ___________

---

## AC1: Watch参数支持

### 测试步骤 1.1: 基础监控功能验证
**预期结果**: 支持 `--watch` 和 `-w` 参数，每60秒自动刷新状态

**测试用例**:

| 测试用例 | 执行命令 | 预期行为 | 实际结果 | 通过/失败 |
|---------|----------|----------|----------|----------|
| TC1.1.1 | `ccpet check --watch` | 立即显示状态，每60秒刷新 | | □ Pass □ Fail |
| TC1.1.2 | `ccpet check -w` | 立即显示状态，每60秒刷新 | | □ Pass □ Fail |

**验证点**:
- [ ] 立即显示当前宠物状态
- [ ] 每60秒自动刷新并显示更新的状态
- [ ] 显示清晰的时间戳标识每次更新
- [ ] 提供停止监控的提示信息（Ctrl+C）

**实际观察**:
- 首次显示时间: ___________
- 第一次刷新时间: ___________
- 刷新间隔: ___________秒

**备注**: ___________

---

### 测试步骤 1.2: 时间戳和提示信息验证
**预期结果**: 显示清晰的时间戳和操作提示

**执行命令**: `ccpet check --watch`

**验证内容**:
- [ ] 每次更新显示时间戳
- [ ] 显示 "Press Ctrl+C to stop monitoring" 或类似提示
- [ ] 时间戳格式清晰易读

**时间戳示例**: ___________
**提示信息**: ___________

**备注**: ___________

---

## AC2: 自定义监控间隔

### 测试步骤 2.1: 自定义间隔参数验证
**预期结果**: 支持 `--interval` 参数，按指定间隔更新状态

**测试用例**:

| 测试用例 | 执行命令 | 预期间隔 | 实际间隔 | 通过/失败 |
|---------|----------|----------|----------|----------|
| TC2.1.1 | `ccpet check --watch --interval 30` | 30秒 | ___秒 | □ Pass □ Fail |
| TC2.1.2 | `ccpet check --watch --interval 10` | 10秒 | ___秒 | □ Pass □ Fail |
| TC2.1.3 | `ccpet check --watch --interval 300` | 300秒(5分钟) | ___秒 | □ Pass □ Fail |

**验证方法**: 
1. 记录开始时间
2. 计算实际刷新间隔
3. 验证与设定值的符合度

**备注**: ___________

---

### 测试步骤 2.2: 间隔时间范围验证
**预期结果**: 间隔时间范围10-300秒，超出范围显示错误信息并使用默认60秒

**边界值测试**:

| 测试用例 | 执行命令 | 预期行为 | 实际结果 | 通过/失败 |
|---------|----------|----------|----------|----------|
| TC2.2.1 | `ccpet check --watch --interval 5` | 错误信息，使用60秒 | | □ Pass □ Fail |
| TC2.2.2 | `ccpet check --watch --interval 9` | 错误信息，使用60秒 | | □ Pass □ Fail |
| TC2.2.3 | `ccpet check --watch --interval 301` | 错误信息，使用60秒 | | □ Pass □ Fail |
| TC2.2.4 | `ccpet check --watch --interval 600` | 错误信息，使用60秒 | | □ Pass □ Fail |

**验证点**:
- [ ] 显示清晰的错误信息
- [ ] 自动回退到默认60秒间隔
- [ ] 监控功能继续正常工作

**错误信息示例**: ___________

**备注**: ___________

---

### 测试步骤 2.3: 间隔时间显示验证
**预期结果**: 在监控开始时显示当前使用的间隔时间

**执行命令**: `ccpet check --watch --interval 45`

**验证点**:
- [ ] 启动信息显示当前间隔时间
- [ ] 格式清晰易读

**启动信息示例**: ___________

**备注**: ___________

---

## AC3: 优雅的退出处理

### 测试步骤 3.1: Ctrl+C退出验证
**预期结果**: 按下Ctrl+C立即停止监控，显示友好退出信息

**测试流程**:
1. 启动监控: `ccpet check --watch`
2. 等待至少一次刷新
3. 按下 Ctrl+C
4. 观察退出行为

**验证点**:
- [ ] 立即停止监控循环
- [ ] 显示友好的退出信息
- [ ] 正常退出程序（无异常）

**退出信息示例**: ___________
**退出时间**: ___________

**备注**: ___________

---

### 测试步骤 3.2: 资源清理验证
**预期结果**: 清理所有定时器和监听器，正常退出（exit code 0）

**验证方法**:
1. 使用系统监控工具观察进程状态
2. 确认退出后无残留进程
3. 检查退出代码

**验证点**:
- [ ] 无残留定时器
- [ ] 无残留进程
- [ ] 退出代码为0

**进程状态**: ___________
**退出代码**: ___________

**备注**: ___________

---

## AC4: 状态变化提醒

### 测试步骤 4.1: 状态变化检测验证
**预期结果**: 检测到能量值、表情或动物类型变化时高亮显示

**测试准备**:
1. 启动监控: `ccpet check --watch --interval 15`
2. 在另一终端执行操作改变宠物状态

**变化测试场景**:

| 变化类型 | 触发操作 | 预期高亮内容 | 实际显示 | 通过/失败 |
|---------|----------|-------------|----------|----------|
| 能量值变化 | `ccpet feed` | 高亮显示新能量值 | | □ Pass □ Fail |
| 表情变化 | 等待时间流逝 | 高亮显示新表情 | | □ Pass □ Fail |
| 动物类型变化 | 修改配置 | 高亮显示新动物emoji | | □ Pass □ Fail |

**验证点**:
- [ ] 变化内容以不同颜色或样式显示
- [ ] 显示变化前后的对比信息
- [ ] 未变化的内容保持正常显示

**备注**: ___________

---

### 测试步骤 4.2: 关键状态变化标识
**预期结果**: 对关键状态变化（如从健康变为饥饿）提供特殊标识

**测试方法**:
1. 启动监控
2. 等待或操作使宠物状态发生关键变化

**关键状态变化场景**:
- [ ] 健康 → 饥饿：特殊标识显示
- [ ] 快乐 → 疲惫：特殊标识显示  
- [ ] 正常 → 需要关注：特殊标识显示

**特殊标识示例**: ___________

**备注**: ___________

---

### 测试步骤 4.3: 显示格式一致性
**预期结果**: 保持与非监控模式相同的显示格式

**验证方法**:
1. 执行 `ccpet check`（非监控模式）
2. 执行 `ccpet check --watch`（监控模式）
3. 对比显示格式

**验证点**:
- [ ] 基础信息显示格式一致
- [ ] 状态信息布局一致
- [ ] 只有变化高亮是额外的

**格式对比**:
- 非监控模式: ___________
- 监控模式: ___________

**备注**: ___________

---

## AC5: 错误处理和恢复

### 测试步骤 5.1: 临时错误处理验证
**预期结果**: 临时错误时显示错误信息但不停止监控

**模拟错误方法**:
1. 启动监控: `ccpet check --watch`
2. 在监控过程中暂时移动或锁定状态文件
3. 观察错误处理行为

**验证点**:
- [ ] 显示错误信息但继续监控
- [ ] 下次更新时尝试重新获取状态
- [ ] 监控循环不中断

**错误信息示例**: ___________

**备注**: ___________

---

### 测试步骤 5.2: 重试机制验证
**预期结果**: 连续3次失败后询问用户是否继续

**测试流程**:
1. 启动监控
2. 模拟持续错误状态（如删除状态文件）
3. 观察重试行为

**重试测试记录**:

| 重试次数 | 时间 | 错误信息 | 系统行为 |
|---------|------|----------|----------|
| 1 | | | |
| 2 | | | |
| 3 | | | |
| 3次后 | | 询问用户是否继续 | |

**验证点**:
- [ ] 连续失败3次后出现用户确认提示
- [ ] 用户可选择继续或退出
- [ ] 选择退出时优雅结束

**备注**: ___________

---

### 测试步骤 5.3: 严重错误处理验证
**预期结果**: 严重错误时优雅退出并显示详细错误信息

**模拟严重错误**:
- 文件系统权限问题
- 系统资源不足
- 其他无法恢复的错误

**验证点**:
- [ ] 显示详细错误信息
- [ ] 优雅退出不崩溃
- [ ] 提供有用的错误诊断信息

**严重错误处理示例**: ___________

**备注**: ___________

---

## 综合测试场景

### 场景1: 完整监控会话测试
**执行步骤**:
1. `ccpet check --watch --interval 20`
2. 观察至少3次状态更新
3. 在监控过程中执行 `ccpet feed` 改变状态
4. 使用 Ctrl+C 退出

**预期结果**:
- 正确启动监控并显示间隔信息
- 按20秒间隔刷新状态
- 检测到feed操作后的状态变化并高亮显示
- 优雅退出并显示友好信息

**实际结果**: ___________
**通过/失败**: □ Pass □ Fail

---

### 场景2: 错误恢复测试
**执行步骤**:
1. 启动监控: `ccpet check --watch`
2. 暂时删除或移动状态文件
3. 观察错误处理
4. 恢复文件
5. 观察监控恢复

**预期结果**:
- 出现错误时显示错误信息
- 监控继续运行不退出
- 文件恢复后监控自动恢复正常

**实际结果**: ___________
**通过/失败**: □ Pass □ Fail

---

### 场景3: 参数组合测试
**执行步骤**:
1. `ccpet check -w --interval 15`
2. 观察参数组合效果

**预期结果**:
- 短参数形式正常工作
- 自定义间隔生效
- 所有监控功能正常

**实际结果**: ___________
**通过/失败**: □ Pass □ Fail

---

## 性能和稳定性测试

### 长时间运行测试
**执行步骤**:
1. `ccpet check --watch --interval 10`
2. 运行至少10分钟
3. 观察内存使用和CPU占用

**验证点**:
- [ ] 内存使用保持稳定，无泄漏
- [ ] CPU占用合理
- [ ] 长时间运行无异常

**性能数据**:
- 初始内存使用: ___________
- 10分钟后内存使用: ___________
- 平均CPU占用: ___________%

**备注**: ___________

---

## 跨平台兼容性测试

### 平台测试记录

| 平台 | 终端 | 基础监控 | 自定义间隔 | Ctrl+C退出 | 错误处理 | 整体评价 |
|------|------|----------|------------|------------|----------|----------|
| macOS | Terminal.app | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | |
| macOS | iTerm2 | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | |
| Windows | PowerShell | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | |
| Windows | CMD | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | |
| Linux | GNOME Terminal | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | □ Pass □ Fail | |

**备注**: ___________

---

## 测试总结

### 测试覆盖情况
- [ ] AC1: Watch参数支持 - 完成
- [ ] AC2: 自定义监控间隔 - 完成
- [ ] AC3: 优雅的退出处理 - 完成
- [ ] AC4: 状态变化提醒 - 完成
- [ ] AC5: 错误处理和恢复 - 完成

### 发现的问题

| 问题编号 | 问题描述 | 重现步骤 | 严重程度 | 状态 |
|---------|----------|----------|----------|------|
| | | | | |
| | | | | |
| | | | | |

### 性能评估
- **内存使用**: □ 优秀 □ 良好 □ 一般 □ 需改进
- **CPU占用**: □ 优秀 □ 良好 □ 一般 □ 需改进  
- **响应速度**: □ 优秀 □ 良好 □ 一般 □ 需改进
- **稳定性**: □ 优秀 □ 良好 □ 一般 □ 需改进

### 用户体验评估
- **易用性**: □ 优秀 □ 良好 □ 一般 □ 需改进
- **信息清晰度**: □ 优秀 □ 良好 □ 一般 □ 需改进
- **错误提示**: □ 优秀 □ 良好 □ 一般 □ 需改进
- **整体满意度**: □ 优秀 □ 良好 □ 一般 □ 需改进

### 整体验收结果
- [ ] **通过** - 所有验收标准都满足，功能正常
- [ ] **条件通过** - 存在非关键问题，但不影响主要功能  
- [ ] **不通过** - 存在关键问题，需要修复后重新测试

### 建议和改进点
___________
___________
___________

### 测试人员签名
**测试人员**: ___________  
**测试日期**: ___________  
**签名**: ___________

### 备注
___________
___________
___________